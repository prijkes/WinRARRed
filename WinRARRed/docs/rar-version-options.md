# RAR Version Command-Line Option Compatibility

This document summarizes which RAR command-line options are supported by different version ranges.

**Generated by `tools/check_rar_options.py` from testing 281 RAR versions.**

## Quick Reference Table

| Option | RAR 2.x | RAR 3.0x | RAR 3.20-3.x | RAR 4.x | RAR 5.0+ |
|--------|---------|----------|--------------|---------|----------|
| `-md64` (no suffix) | ✓ | ⚠️ | ✓ | ✓ | ✓ |
| `-md128` (no suffix) | ✓ | ⚠️ | ✓ | ✓ | ✓ |
| `-md64k` (k suffix) | ✓ | ⚠️ | ✓ | ✓ | ✓ |
| `-md128k` (k suffix) | ✓ | ⚠️ | ✓ | ✓ | ✓ |
| `-md1m` (MB suffix) | ✓ | ✗ | ✗ | ✗ | ✓ |
| `-md4m` (MB suffix) | ✓ | ✗ | ✗ | ✗ | ✓ |
| `-tsm-` (timestamp) | ✗ | ✗ | ✓ | ✓ | ✓ |
| `-tsc-` (timestamp) | ✗ | ✗ | ✓ | ✓ | ✓ |
| `-tsa-` (timestamp) | ✗ | ✗ | ✓ | ✓ | ✓ |
| `-ma4` (RAR4 format) | ✗ | ✗ | ✗ | ✗ | ✓ |
| `-ma5` (RAR5 format) | ✗ | ✗ | ✗ | ✗ | ✓ |

**Legend:**
- ✓ = Fully supported
- ⚠️ = Partially supported (some versions work, some don't)
- ✗ = Not supported

## Detailed Version Information

### Dictionary Size Options

All RAR versions support dictionary sizes from 64KB to 4MB for RAR4 format archives.

**Option formats:**
- No suffix: `-md64`, `-md128`, `-md256`, `-md512`, `-md1024`, `-md2048`, `-md4096`
- KB suffix: `-md64k`, `-md128k`, `-md256k`, `-md512k`, `-md1024k`, `-md2048k`, `-md4096k`
- MB suffix: `-md1m`, `-md2m`, `-md4m` (RAR 2.x and 5.0+ only)

**Key findings:**
1. Both `-md128` and `-md128k` work identically for RAR 2.x, 3.20+, 4.x, and 5.x
2. RAR 3.0x-3.11 has buggy dictionary option support (use `-md128k` format)
3. MB suffix options (`-md4m`) are supported in RAR 2.x, **removed** in RAR 3.x/4.x, and **re-added** in RAR 5.x
4. For maximum compatibility, use the `-md128k` format (k suffix)

### Timestamp Options

Timestamp options control which file times are preserved in the archive.

| Option | Description | Minimum Version |
|--------|-------------|-----------------|
| `-tsm-` | Disable modification time | RAR 3.20 |
| `-tsc-` | Disable creation time | RAR 3.20 |
| `-tsa-` | Disable access time | RAR 3.20 |
| `-tsm0` to `-tsm4` | Mtime precision levels | RAR 3.20 |
| `-tsc0` to `-tsc4` | Ctime precision levels | RAR 3.20 |
| `-tsa0` to `-tsa4` | Atime precision levels | RAR 3.20 |

**Important:** Versions before RAR 3.20 silently ignore these options (no error, but no effect).

### Archive Format Options

| Option | Description | Minimum Version |
|--------|-------------|-----------------|
| `-ma4` | Create RAR4 format archive | RAR 5.00 |
| `-ma5` | Create RAR5 format archive | RAR 5.00 |

**Critical:** RAR 5.50+ defaults to creating RAR5 format archives. Use `-ma4` to create RAR4 format archives for scene release reconstruction.

### Problematic Versions

These versions have known issues and should generally be avoided:

| Version | Issues |
|---------|--------|
| `wrar30b1` | Many options fail, very buggy beta |
| `wrar39b1` | Basic archive creation sometimes fails |
| RAR 3.0x (all) | Inconsistent dictionary option support |

## Brute-Force Script Recommendations

When using `bruteforce_rar.py`:

1. **Skip RAR < 3.00**: Very old versions with compatibility issues
2. **Skip RAR 3.0x betas**: Too buggy for reliable reconstruction
3. **For RAR 3.20-4.x**: Use `-md128k` format (k suffix), timestamp options work
4. **For RAR 5.50+**: Always add `-ma4` to create RAR4 format

### Version Filtering in Scripts

```python
# Version compatibility constants
MIN_VERSION_BASIC = 300           # RAR 3.00+
MIN_VERSION_TIMESTAMP = 320       # RAR 3.20+ for -tsm/-tsc/-tsa
MIN_VERSION_MA4_NEEDED = 550      # RAR 5.50+ requires -ma4 for RAR4

def filter_params_for_version(params, version):
    filtered = []
    for param in params:
        # Skip timestamp options for < 3.20
        if param.startswith('-ts') and version < 320:
            continue
        filtered.append(param)

    # Add -ma4 for 5.50+ to force RAR4 format
    if version >= 550:
        filtered.insert(0, '-ma4')

    return filtered
```

## Testing Methodology

The capability data was generated by:
1. Running `check_rar_options.py` against 281 RAR versions
2. Testing 51 different command-line options per version
3. Checking if each option creates a valid archive

Full results are saved in `tools/rar_options.json`.
